imports:
    - { resource: services/registration.yml }
    - { resource: services/reset_password.yml }

parameters:
    vs_users.login_route: 'app_login'
    vs_users.login_by: 'email'
    vs_users.default_redirect: 'app_home'

services:
    VS\UsersBundle\Repository\UsersRepository: '@vs_users.repository.users'
    
    vs_users.form.type.users:
        class: VS\UsersBundle\Form\UserCrudFormType
        tags:
            - { name: form.type, alias: 'vs_users_users' }
        arguments: ['@doctrine']

    vs_users.command.create_user:
        class: VS\UsersBundle\Command\CreateUserCommand
        arguments:
            - '@vs_users.manager.user'
        tags:
            - { name: console.command }
            
    vs_users.manager.user:
        class: VS\UsersBundle\Security\UserManager
        public: true
        arguments:
            - '@vs_users.factory.users'
            - '@vs_users.repository.users'
            - '@doctrine.orm.entity_manager'
            - '@security.encoder_factory'
    
    vs_users.security.login_form_authenticator:
        class: VS\UsersBundle\Security\LoginFormAuthenticator
        arguments:
            - '@router'
            - '@security.csrf.token_manager'
            - '@security.encoder_factory'
            - '@vs_users.repository.users'
            - { loginRoute: '%vs_users.login_route%', loginBy: '%vs_users.login_by%', defaultRedirect: '%vs_users.default_redirect%' }

